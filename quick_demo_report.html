<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State Machine History - demo-machine</title>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        padding: 30px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    h1 {
        color: #333;
        margin-bottom: 20px;
        font-size: 2em;
    }

    h2 {
        color: #555;
        margin-bottom: 15px;
        font-size: 1.5em;
    }

    h3 {
        color: #666;
        margin-bottom: 15px;
        font-size: 1.2em;
    }

    .machine-info {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
    }

    .machine-info p {
        color: #666;
        margin: 5px 0;
    }

    .machine-selector {
        margin-bottom: 30px;
        padding: 15px;
        background: #f0f0f0;
        border-radius: 8px;
    }

    .machine-selector select {
        padding: 8px 15px;
        font-size: 16px;
        border: 2px solid #667eea;
        border-radius: 4px;
        background: white;
        cursor: pointer;
    }

    .state-diagram {
        background: #f0f8ff;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
        overflow-x: auto;
    }

    .flow {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 15px;
        white-space: nowrap;
    }

    .state {
        background: #667eea;
        color: white;
        padding: 10px 20px;
        border-radius: 20px;
        font-weight: bold;
    }

    .state.final {
        background: #28a745;
    }

    .event {
        background: #ffc107;
        color: #333;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 0.9em;
    }

    .arrow {
        color: #999;
        font-size: 1.5em;
    }

    .timeline {
        margin-top: 30px;
    }

    .timeline-entry {
        margin-bottom: 20px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
    }

    .timeline-header {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: #f8f9fa;
        cursor: pointer;
        transition: background 0.3s;
    }

    .timeline-header:hover {
        background: #e9ecef;
    }

    .version {
        background: #6c757d;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.9em;
    }

    .transition {
        font-weight: 600;
        color: #333;
    }

    .event-badge {
        background: #17a2b8;
        color: white;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.85em;
    }

    .duration {
        color: #28a745;
        font-size: 0.9em;
        margin-left: auto;
    }

    .timestamp {
        color: #999;
        font-size: 0.85em;
    }

    .timeline-details {
        padding: 20px;
        background: white;
        border-top: 1px solid #e0e0e0;
    }

    .context-section {
        margin-bottom: 20px;
    }

    .context-section h4 {
        color: #555;
        margin-bottom: 10px;
    }

    .json-display {
        background: #f6f8fa;
        padding: 15px;
        border-radius: 6px;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        overflow-x: auto;
        max-height: 300px;
        overflow-y: auto;
    }

    .hash {
        color: #999;
        font-size: 0.85em;
        margin-top: 5px;
        font-family: monospace;
    }

    .diff-section {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #e0e0e0;
    }

    .diff-display {
        background: #f6f8fa;
        padding: 15px;
        border-radius: 6px;
        font-family: monospace;
        font-size: 0.9em;
    }

    .diff-add {
        background: #d4edda;
        color: #155724;
        padding: 2px 4px;
        border-radius: 2px;
    }

    .diff-remove {
        background: #f8d7da;
        color: #721c24;
        padding: 2px 4px;
        border-radius: 2px;
    }

    .summary {
        background: #e8f4f8;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .machine-status, .state-status {
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.8em;
        font-weight: bold;
    }

    .status-online {
        background: #28a745;
        color: white;
    }

    .status-offline {
        background: #dc3545;
        color: white;
    }

    .registry-status {
        background: #6c757d;
        color: white;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.8em;
    }

    .status-section {
        margin-bottom: 20px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 6px;
    }

    .status-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        margin-top: 10px;
    }

    .status-item {
        font-size: 0.9em;
        color: #333;
    }

    .event-section {
        margin-bottom: 20px;
        padding: 15px;
        background: #fff3cd;
        border-radius: 6px;
    }

    .event-section h5 {
        color: #856404;
        margin: 10px 0 5px 0;
        font-size: 1em;
    }
</style>
</head>
<body>
    <div class="container">
        <h1>State Machine Transition History</h1>
        <div class="machine-info">
            <h2>Machine: demo-machine</h2>
            <p>Total Transitions: 2</p>
            <p>Type: SimpleEntity</p>
            <p>Run ID: quick-demo-run</p>
        </div>

        <div class="state-diagram">
            <h3>State Flow</h3>
            <div class="flow">
                <span class="state">START</span>
                <span class="arrow">→</span>
                <span class="event">[PROCESS]</span>
                <span class="arrow">→</span>
                <span class="state">WORKING</span>
                <span class="arrow">→</span>
                <span class="event">[FINISH]</span>
                <span class="arrow">→</span>
                <span class="state final">END</span>
            </div>
        </div>

        <div class="timeline">
            <h3>Transition Timeline</h3>
            <div class="timeline-entry">
                <div class="timeline-header" onclick="toggleDetails('snapshot-1')">
                    <span class="version">v1</span>
                    <span class="transition">START → WORKING</span>
                    <span class="event-badge">PROCESS</span>
                    <span class="duration">5ms</span>
                    <span class="machine-status status-online">ONLINE</span>
                    <span class="timestamp">2025-08-09T16:28:22.488180431</span>
                </div>
                <div class="timeline-details" id="snapshot-1" style="display: none;">
                    <div class="status-section">
                        <h4>Status Information:</h4>
                        <div class="status-grid">
                            <div class="status-item">Machine Status: <span class="status-online">ONLINE</span></div>
                            <div class="status-item">State Mode: <span class="status-online">ONLINE</span></div>
                            <div class="status-item">Registry: <span class="registry-status">NOT_REGISTERED</span></div>
                        </div>
                    </div>
                    <div class="event-section">
                        <h4>Event Details:</h4>
                        <h5>Full Event Payload:</h5>
                        <pre class="json-display">{
  "eventType" : "PROCESS",
  "payload" : null,
  "timestamp" : 1754735302460,
  "description" : "Generic event: PROCESS"
}</pre>
                        <h5>Event Parameters:</h5>
                        <pre class="json-display">{
  "eventType" : "PROCESS",
  "eventClass" : "GenericStateMachineEvent",
  "timestamp" : 1754735302512,
  "parameters" : {
    "payload" : null,
    "eventType" : "PROCESS",
    "timestamp" : 1754735302460
  }
}</pre>
                    </div>
                    <div class="context-section">
                        <h4>Context After:</h4>
                        <pre class="json-display">{
  "status" : "Initial",
  "itemsProcessed" : 0,
  "timestamp" : 1754735302315
}</pre>
                        <p class="hash">Hash: 87cd5fddd9a6be93...</p>
                    </div>
                </div>
            </div>
            <div class="timeline-entry">
                <div class="timeline-header" onclick="toggleDetails('snapshot-2')">
                    <span class="version">v2</span>
                    <span class="transition">WORKING → END</span>
                    <span class="event-badge">FINISH</span>
                    <span class="duration">0ms</span>
                    <span class="machine-status status-online">ONLINE</span>
                    <span class="timestamp">2025-08-09T16:28:22.539559905</span>
                </div>
                <div class="timeline-details" id="snapshot-2" style="display: none;">
                    <div class="status-section">
                        <h4>Status Information:</h4>
                        <div class="status-grid">
                            <div class="status-item">Machine Status: <span class="status-online">ONLINE</span></div>
                            <div class="status-item">State Mode: <span class="status-online">ONLINE</span></div>
                            <div class="status-item">Registry: <span class="registry-status">NOT_REGISTERED</span></div>
                        </div>
                    </div>
                    <div class="event-section">
                        <h4>Event Details:</h4>
                        <h5>Full Event Payload:</h5>
                        <pre class="json-display">{
  "eventType" : "FINISH",
  "payload" : null,
  "timestamp" : 1754735302539,
  "description" : "Generic event: FINISH"
}</pre>
                        <h5>Event Parameters:</h5>
                        <pre class="json-display">{
  "eventType" : "FINISH",
  "eventClass" : "GenericStateMachineEvent",
  "timestamp" : 1754735302539,
  "parameters" : {
    "payload" : null,
    "eventType" : "FINISH",
    "timestamp" : 1754735302539
  }
}</pre>
                    </div>
                    <div class="context-section">
                        <h4>Context After:</h4>
                        <pre class="json-display">{
  "status" : "Processing started",
  "itemsProcessed" : 50,
  "timestamp" : 1754735302315
}</pre>
                        <p class="hash">Hash: bd4648b53bf8b4cc...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script>
    function toggleDetails(id) {
        const element = document.getElementById(id);
        if (element) {
            element.style.display = element.style.display === 'none' ? 'block' : 'none';
        }
    }

    function showMachine(machineId) {
        // Hide all machine contents
        const allContents = document.querySelectorAll('.machine-content');
        allContents.forEach(content => {
            content.style.display = 'none';
        });

        // Show selected machine content
        const selected = document.getElementById('machine-' + machineId);
        if (selected) {
            selected.style.display = 'block';
        }
    }

    // Initialize first machine as visible
    document.addEventListener('DOMContentLoaded', function() {
        const firstMachine = document.querySelector('.machine-content');
        if (firstMachine) {
            firstMachine.style.display = 'block';
        }
    });
</script>
</body>
</html>
